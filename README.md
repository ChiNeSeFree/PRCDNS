# PRCDNS
准确、CDN友好的DNS服务软件
### 原理
备案域名使用本地DNS，其他使用`dig @OPENDNS +tcp -p 443 domain`
### 优势与劣势
天然域名白名单，更新及时，一次编码，到处运行，无需更新。   
查询域名是否备案，成为关键挑战
### DNS查询请求处理：

 1. 根据请求域名www.sohu.com提取出一级域名sohu.com。
 2. 判断sohu.com是否备案
    - 查询本地缓存（文件\Redis\RocksDB），存在，走原理逻辑
    - 不存在，查询[站长之家](http://icp.chinaz.com/sohu.com)，缓存查询结果和`该单位还备案了以下网站`中的结果，走原理逻辑。
    
 3. 配置文件的设定。
    - 本地缓存时间设定，默认半年。
    - 本地DNS设定，默认本地带宽提供商提供的DNS（推荐），可以自定义。
    - 无污染上游设定，默认OPENDNS tcp 443，可以自定义，使用ss服务器上的DNS（推荐）。

### 问题
>`待定`考虑到站长之家可能封接口或者增加验证码，导致PRCDNS失效，也许应该在一台服务器上再做一层缓存，所有客户端从这个缓存上查询数据，考虑百度云的bae，价格低、延迟低。这样就产生另外一个问题，站长之家封这个缓存。目前想到的办法是伪造UA（User Agent浏览器标识）。

### TODO LIST
1. 查询站长之家
2. 缓存查询结果
3. 访问上游DNS
4. 建立DNS服务
    